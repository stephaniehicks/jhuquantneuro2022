<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Problem Set 2 • jhuquantneuro2022</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Problem Set 2">
<meta property="og:description" content="Problem Set 2
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jhuquantneuro2022</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro-bioconductor.html">Introduction to Bioconductor</a>
    </li>
    <li>
      <a href="../articles/intro-single-cell.html">Overview of single-cell analysis in R/Bioconductor</a>
    </li>
    <li>
      <a href="../articles/data-viz.html">Data visualizations and the tidyverse</a>
    </li>
    <li>
      <a href="../articles/problem-set.html">Problem Set 2</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://twitter.com/stephaniehicks" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stephaniehicks/jhuquantneuro2022" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Problem Set 2</h1>
                        <h4 data-toc-skip class="author">Stephanie
Hicks</h4>
            
      
      
      <div class="hidden name"><code>problem-set.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p><strong>Due date: Sept 18 at 11:59pm</strong></p>
<div class="section level3">
<h3 id="to-submit-your-problem-set">To submit your problem set<a class="anchor" aria-label="anchor" href="#to-submit-your-problem-set"></a>
</h3>
<p>Please write up your project using R Markdown and <code>knitr</code>.
Please <strong>show all your code</strong> for each of the answers to
each part. Follow previous instructions in Problem Set 1 to submit.</p>
</div>
</div>
<div class="section level2">
<h2 id="part-1-explore-spotify-songs">Part 1: Explore spotify songs!<a class="anchor" aria-label="anchor" href="#part-1-explore-spotify-songs"></a>
</h2>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>That data for this part of the assignment comes from <a href="https://www.tidytuesday.com" class="external-link">TidyTuesday</a>, which is a weekly
podcast and global <a href="https://github.com/rfordatascience/tidytuesday" class="external-link">community
activity</a> brought to you by the R4DS Online Learning Community. The
goal of TidyTuesday is to help R learners learn in real-world
contexts.</p>
<div class="figure" style="text-align: center">
<img src="https://github.com/rfordatascience/tidytuesday/raw/master/static/tt_logo.png" alt="Icon from TidyTuesday" width="60%"><p class="caption">
Icon from TidyTuesday
</p>
</div>
<p>[<strong>Source</strong>: <a href="https://github.com/rfordatascience/tidytuesday/blob/master/static/tt_logo.png" class="external-link">TidyTuesday</a>]</p>
<p>To access the data, you need to install the <code>tidytuesdayR</code>
R package and use the function <code>tt_load()</code> with the date of
‘2020-01-21’ to load the data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tidytuesdayR"</span><span class="op">)</span></span></code></pre></div>
<p>This is how you can download the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tuesdata</span> <span class="op">&lt;-</span> <span class="fu">tidytuesdayR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidytuesdayR/man/tt_load.html" class="external-link">tt_load</a></span><span class="op">(</span><span class="st">'2020-01-21'</span><span class="op">)</span></span>
<span><span class="va">spotify_songs</span> <span class="op">&lt;-</span> <span class="va">tuesdata</span><span class="op">$</span><span class="va">spotify_songs</span></span></code></pre></div>
<p>However, if you use this code, you will hit an API limit after trying
to compile the document a few times. Instead, I suggest you use the
following code below. Here, I provide the code below for you to avoid
re-downloading data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tests if a directory named "data" exists locally</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span><span class="op">)</span> <span class="op">}</span></span>
<span></span>
<span><span class="co"># saves data only once (not each time you knit a R Markdown)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"spotify_songs.RDS"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">url_csv</span> <span class="op">&lt;-</span> <span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-01-21/spotify_songs.csv'</span></span>
<span>  <span class="va">spotify_songs</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">url_csv</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># save the file to RDS objects</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">spotify_songs</span>, file<span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"spotify_songs.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Here we read in the <code>.RDS</code> dataset locally from our
computing environment:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spotify_songs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"spotify_songs.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">spotify_songs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 32,833 × 23</span></span></span>
<span><span class="co">##    track_id      track…¹ track…² track…³ track…⁴ track…⁵ track…⁶ playl…⁷ playl…⁸</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 6f807x0ima9a… I Don'… Ed She…      66 2oCs0D… I Don'… 2019-0… Pop Re… 37i9dQ…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 0r7CVbZTWZgb… Memori… Maroon…      67 63rPSO… Memori… 2019-1… Pop Re… 37i9dQ…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 1z1Hg7Vb0AhH… All th… Zara L…      70 1HoSmj… All th… 2019-0… Pop Re… 37i9dQ…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 75FpbthrwQmz… Call Y… The Ch…      60 1nqYsO… Call Y… 2019-0… Pop Re… 37i9dQ…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 1e8PAfcKUYoK… Someon… Lewis …      69 7m7vv9… Someon… 2019-0… Pop Re… 37i9dQ…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 7fvUMiyapMsR… Beauti… Ed She…      67 2yiy9c… Beauti… 2019-0… Pop Re… 37i9dQ…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 2OAylPUDDfwR… Never … Katy P…      62 7INHYS… Never … 2019-0… Pop Re… 37i9dQ…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 6b1RNvAcJjQH… Post M… Sam Fe…      69 6703SR… Post M… 2019-0… Pop Re… 37i9dQ…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 7bF6tCO3gFb8… Tough … Avicii       68 7CvAfG… Tough … 2019-0… Pop Re… 37i9dQ…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 1IXGILkPm0tO… If I C… Shawn …      67 4Qxzbf… If I C… 2019-0… Pop Re… 37i9dQ…</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 32,823 more rows, 14 more variables: playlist_genre &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   playlist_subgenre &lt;chr&gt;, danceability &lt;dbl&gt;, energy &lt;dbl&gt;, key &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   loudness &lt;dbl&gt;, mode &lt;dbl&gt;, speechiness &lt;dbl&gt;, acousticness &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   instrumentalness &lt;dbl&gt;, liveness &lt;dbl&gt;, valence &lt;dbl&gt;, tempo &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   duration_ms &lt;dbl&gt;, and abbreviated variable names ¹​track_name,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ²​track_artist, ³​track_popularity, ⁴​track_album_id, ⁵​track_album_name,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ⁶​track_album_release_date, ⁷​playlist_name, ⁸​playlist_id</span></span></span></code></pre>
<p>We can take a glimpse at the data</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">spotify_songs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 32,833</span></span>
<span><span class="co">## Columns: 23</span></span>
<span><span class="co">## $ track_id                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "6f807x0ima9a1j3VPbc7VN", "0r7CVbZTWZgbTCYdfa…</span></span>
<span><span class="co">## $ track_name               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "I Don't Care (with Justin Bieber) - Loud Lux…</span></span>
<span><span class="co">## $ track_artist             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Ed Sheeran", "Maroon 5", "Zara Larsson", "Th…</span></span>
<span><span class="co">## $ track_popularity         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 66, 67, 70, 60, 69, 67, 62, 69, 68, 67, 58, 6…</span></span>
<span><span class="co">## $ track_album_id           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2oCs0DGTsRO98Gh5ZSl2Cx", "63rPSO264uRjW1X5E6…</span></span>
<span><span class="co">## $ track_album_name         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "I Don't Care (with Justin Bieber) [Loud Luxu…</span></span>
<span><span class="co">## $ track_album_release_date <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2019-06-14", "2019-12-13", "2019-07-05", "20…</span></span>
<span><span class="co">## $ playlist_name            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Pop Remix", "Pop Remix", "Pop Remix", "Pop R…</span></span>
<span><span class="co">## $ playlist_id              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "37i9dQZF1DXcZDD7cfEKhW", "37i9dQZF1DXcZDD7cf…</span></span>
<span><span class="co">## $ playlist_genre           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "pop", "pop", "pop", "pop", "pop", "pop", "po…</span></span>
<span><span class="co">## $ playlist_subgenre        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "dance pop", "dance pop", "dance pop", "dance…</span></span>
<span><span class="co">## $ danceability             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.748, 0.726, 0.675, 0.718, 0.650, 0.675, 0.4…</span></span>
<span><span class="co">## $ energy                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.916, 0.815, 0.931, 0.930, 0.833, 0.919, 0.8…</span></span>
<span><span class="co">## $ key                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 6, 11, 1, 7, 1, 8, 5, 4, 8, 2, 6, 8, 1, 5, 5,…</span></span>
<span><span class="co">## $ loudness                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -2.634, -4.969, -3.432, -3.778, -4.672, -5.38…</span></span>
<span><span class="co">## $ mode                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, …</span></span>
<span><span class="co">## $ speechiness              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0583, 0.0373, 0.0742, 0.1020, 0.0359, 0.127…</span></span>
<span><span class="co">## $ acousticness             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.10200, 0.07240, 0.07940, 0.02870, 0.08030, …</span></span>
<span><span class="co">## $ instrumentalness         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00e+00, 4.21e-03, 2.33e-05, 9.43e-06, 0.00e…</span></span>
<span><span class="co">## $ liveness                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0653, 0.3570, 0.1100, 0.2040, 0.0833, 0.143…</span></span>
<span><span class="co">## $ valence                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.518, 0.693, 0.613, 0.277, 0.725, 0.585, 0.1…</span></span>
<span><span class="co">## $ tempo                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 122.036, 99.972, 124.008, 121.956, 123.976, 1…</span></span>
<span><span class="co">## $ duration_ms              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 194754, 162600, 176616, 169093, 189052, 16304…</span></span></code></pre>
<p>For all of the questions below, you can ignore the missing values in
the dataset, so e.g. when taking averages, just remove the missing
values before taking the average, if needed.</p>
</div>
<div class="section level3">
<h3 id="tasks">Tasks<a class="anchor" aria-label="anchor" href="#tasks"></a>
</h3>
<p>Use functions from <code>dplyr</code> and <code>ggplot2</code> to
answer the following questions.</p>
<ol style="list-style-type: decimal">
<li>How many songs are in each genre?</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add your solution here</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>What is average value of <code>energy</code> and
<code>acousticness</code> in the <code>latin</code> genre in this
dataset?</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add your solution here</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Calculate the average duration of song (in minutes) across all
subgenres. Which subgenre has the longest song on average?</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add your solution here</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Make two boxplots side-by-side of the <code>danceability</code> of
songs stratifying by whether a song has a fast or slow tempo. Define
fast tempo as any song that has a <code>tempo</code> above its median
value. On average, which songs are more danceable?</li>
</ol>
<p><strong>Hint</strong>: You may find the <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when()</a></code>
function useful in this part, which can be used to map values from one
variable to different values in a new variable (when used in a
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> call).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Generate some random numbers</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 1</span></span></span>
<span><span class="co">##        x</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.630</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  0.465</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>  1.67</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create a new column that indicates whether the value of 'x' is positive or negative</span></span>
<span><span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is_positive <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>                <span class="va">x</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Yes"</span>,</span>
<span>                <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"No"</span></span>
<span>        <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 100 × 2</span></span></span>
<span><span class="co">##         x is_positive</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">0.630</span> No         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  0.465 Yes        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  1.67  Yes        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">1.04</span>  No         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.170</span> No         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>  1.97  Yes        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">1.55</span>  No         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.276</span> No         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  1.51  Yes        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">2.15</span>  No         </span></span>
<span><span class="co">## <span style="color: #949494;"># … with 90 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add your solution here</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="part-2-single-cell-data-analysis">Part 2: Single-cell data analysis<a class="anchor" aria-label="anchor" href="#part-2-single-cell-data-analysis"></a>
</h2>
<div class="section level3">
<h3 id="data-1">Data<a class="anchor" aria-label="anchor" href="#data-1"></a>
</h3>
<p>The <em><a href="https://bioconductor.org/packages/3.15/scRNAseq" class="external-link">scRNAseq</a></em>
package provides convenient access to several publicly available data
sets in the form of <code>SingleCellExperiment</code> objects. The focus
of this package is to capture datasets that are not easily read into R
with a one-liner from, e.g., <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv()</a></code>. Instead, the
necessary data munging is already done so that users only need to call a
single function to obtain a well-formed
<code>SingleCellExperiment</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scRNAseq</span><span class="op">)</span></span></code></pre></div>
<p>To see the list of available datasets, use the
<code><a href="https://rdrr.io/pkg/scRNAseq/man/listDatasets.html" class="external-link">listDatasets()</a></code> function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scRNAseq/man/listDatasets.html" class="external-link">listDatasets</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">out</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 61 rows and 5 columns</span></span>
<span><span class="co">##                  Reference  Taxonomy               Part    Number</span></span>
<span><span class="co">##                &lt;character&gt; &lt;integer&gt;        &lt;character&gt; &lt;integer&gt;</span></span>
<span><span class="co">## 1   @aztekin2019identifi..      8355               tail     13199</span></span>
<span><span class="co">## 2   @bach2017differentia..     10090      mammary gland     25806</span></span>
<span><span class="co">## 3           @bacher2020low      9606            T cells    104417</span></span>
<span><span class="co">## 4     @baron2016singlecell      9606           pancreas      8569</span></span>
<span><span class="co">## 5     @baron2016singlecell     10090           pancreas      1886</span></span>
<span><span class="co">## ...                    ...       ...                ...       ...</span></span>
<span><span class="co">## 57    @zeisel2018molecular     10090     nervous system    160796</span></span>
<span><span class="co">## 58     @zhao2020singlecell      9606 liver immune cells     68100</span></span>
<span><span class="co">## 59    @zhong2018singlecell      9606  prefrontal cortex      2394</span></span>
<span><span class="co">## 60  @zilionis2019singlec..      9606               lung    173954</span></span>
<span><span class="co">## 61  @zilionis2019singlec..     10090               lung     17549</span></span>
<span><span class="co">##                       Call</span></span>
<span><span class="co">##                &lt;character&gt;</span></span>
<span><span class="co">## 1        AztekinTailData()</span></span>
<span><span class="co">## 2        BachMammaryData()</span></span>
<span><span class="co">## 3        BacherTCellData()</span></span>
<span><span class="co">## 4   BaronPancreasData('h..</span></span>
<span><span class="co">## 5   BaronPancreasData('m..</span></span>
<span><span class="co">## ...                    ...</span></span>
<span><span class="co">## 57     ZeiselNervousData()</span></span>
<span><span class="co">## 58   ZhaoImmuneLiverData()</span></span>
<span><span class="co">## 59   ZhongPrefrontalData()</span></span>
<span><span class="co">## 60      ZilionisLungData()</span></span>
<span><span class="co">## 61  ZilionisLungData('mo..</span></span></code></pre>
<p>You can load a dataset the following way:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scRNAseq/man/ZeiselBrainData.html" class="external-link">ZeiselBrainData</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sce</span></span></code></pre></div>
<pre><code><span><span class="co">## class: SingleCellExperiment </span></span>
<span><span class="co">## dim: 20006 3005 </span></span>
<span><span class="co">## metadata(0):</span></span>
<span><span class="co">## assays(1): counts</span></span>
<span><span class="co">## rownames(20006): Tspan12 Tshz1 ... mt-Rnr1 mt-Nd4l</span></span>
<span><span class="co">## rowData names(1): featureType</span></span>
<span><span class="co">## colnames(3005): 1772071015_C02 1772071017_G12 ... 1772066098_A12</span></span>
<span><span class="co">##   1772058148_F03</span></span>
<span><span class="co">## colData names(10): tissue group # ... level1class level2class</span></span>
<span><span class="co">## reducedDimNames(0):</span></span>
<span><span class="co">## mainExpName: endogenous</span></span>
<span><span class="co">## altExpNames(2): ERCC repeat</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="tasks-1">Tasks<a class="anchor" aria-label="anchor" href="#tasks-1"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Pick a scRNA-seq dataset that has more than 5,000 cells and load
the <code>SingleCellExperiment</code> (or <code>sce</code>)
object.</p></li>
<li><p>Show the number of number of genes and number of observations in
the <code>sce</code> object.</p></li>
<li>
<p>Using the material we learned in the lecture, analyze the
scRNA-seq data using the Biocondutor packages we learned about. This
should include (but not be limited to)</p>
<ul>
<li>Quality control (you must use at least two different QC
metrics)</li>
<li>Normalization</li>
<li>Feature selection using highly variable genes</li>
<li>Dimensionality reduction using PCA</li>
<li>Data visualization using tSNE or UMAP</li>
<li>Unsupervised clustering (your choice of method!)</li>
</ul>
</li>
<li><p>At the end of your analysis, show a plot of both (i) the PCA plot
and (ii) either the tSNE or UMAP plot with the colors represented by the
predicted labels from the clustering algorithm.</p></li>
<li><p>For each component described in Task #3, write 3-4 sentences
naming and describing the idea behind the methodology you used, along
with interpreting the output.</p></li>
</ol>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add your solution here</span></span></code></pre></div>
<div class="section level4">
<h4 id="useful-tips">Useful tips<a class="anchor" aria-label="anchor" href="#useful-tips"></a>
</h4>
<ul>
<li>If the original dataset was not provided with Ensembl annotation, we
can map the identifiers with <code>ensembl=TRUE</code>. Any genes
without a corresponding <code>Ensembl</code> identifier is discarded
from the dataset.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scRNAseq/man/ZeiselBrainData.html" class="external-link">ZeiselBrainData</a></span><span class="op">(</span>ensembl<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "ENSMUSG00000029669" "ENSMUSG00000046982" "ENSMUSG00000039735"</span></span>
<span><span class="co">## [4] "ENSMUSG00000033453" "ENSMUSG00000046798" "ENSMUSG00000034009"</span></span></code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Stephanie C. Hicks.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
