<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data visualizations and the tidyverse • jhuquantneuro2022</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Data visualizations and the tidyverse">
<meta property="og:description" content="An introduction to data visualizations and the tidyverse
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jhuquantneuro2022</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro-bioconductor.html">Introduction to Bioconductor</a>
    </li>
    <li>
      <a href="../articles/intro-single-cell.html">Overview of single-cell analysis in R/Bioconductor</a>
    </li>
    <li>
      <a href="../articles/data-viz.html">Data visualizations and the tidyverse</a>
    </li>
    <li>
      <a href="../articles/problem-set.html">Problem Set 2</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://twitter.com/stephaniehicks" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stephaniehicks/jhuquantneuro2022" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Data visualizations and the tidyverse</h1>
                        <h4 data-toc-skip class="author">Stephanie
Hicks</h4>
            
      
      
      <div class="hidden name"><code>data-viz.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<div class="section level3">
<h3 id="key-resources">Key resources<a class="anchor" aria-label="anchor" href="#key-resources"></a>
</h3>
<ul>
<li>Workshop material: <a href="https://stephaniehicks.com/jhuquantneuro2022">pkgdown
website</a>
</li>
<li>Code: <a href="https://github.com/stephaniehicks/jhuquantneuro2022" class="external-link">GitHub</a>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="learning-objectives">Learning objectives<a class="anchor" aria-label="anchor" href="#learning-objectives"></a>
</h3>
<ul>
<li>Know difference between relative vs absolute paths</li>
<li>Use modern R packages (<code>readr</code>) for reading and writing
data in R</li>
<li>Understand the advantages of a <code>tibble</code> and
<code>data.frame</code> data objects in R</li>
<li>Learn about the <code>dplyr</code> R package to manage data
frames</li>
<li>Recognize the key verbs to manage data frames in
<code>dplyr</code>
</li>
<li>Use the “pipe” operator to combine verbs together</li>
<li>Be able to build up layers of graphics using
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="reading-and-writing-data">Reading and writing data<a class="anchor" aria-label="anchor" href="#reading-and-writing-data"></a>
</h2>
<p>Here, we introduce ays to read and write data (e.g. <code>.txt</code>
and <code>.csv</code> files) using base R functions as well as more
modern R packages, such as <code>readr</code>, which is typically <a href="https://r4ds.had.co.nz/data-import.html#compared-to-base-r" class="external-link">10x
faster than base R</a>.</p>
<div class="section level3">
<h3 id="relative-paths">Relative paths<a class="anchor" aria-label="anchor" href="#relative-paths"></a>
</h3>
<p>When you open up a <code>.Rproj</code> file, RStudio changes the path
(location on your computer) to the <code>.Rproj</code> location.</p>
<p>After opening up a <code>.Rproj</code> file, you can test this by</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>When you open up someone else’s R code or analysis, you might also
see the</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>function being used which explicitly tells R to change the absolute
path or absolute location of which directory to move into.</p>
<p>For example, say I want to clone a GitHub repo from Roger, which has
100 R script files, and in every one of those files at the top is:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:\Users\Roger\path\only</span><span class="sc">\t</span><span class="st">hat\Roger\has"</span>)</span></code></pre></div>
<p>The problem is, if I want to use his code, I will need to go and
hand-edit every single one of those paths
(<code>C:\Users\Roger\path\only\that\Roger\has</code>) to the path that
I want to use on my computer or wherever I saved the folder on my
computer
(e.g. <code>/Users/Stephanie/Documents/path/only/I/have</code>).</p>
<ol style="list-style-type: decimal">
<li>This is an unsustainable practice.</li>
<li>I can go in and manually edit the path, but this assumes I know how
to set a working directory. Not everyone does.</li>
</ol>
<p>So instead of absolute paths:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="st">"/Users/jtleek/data"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="st">"~/Desktop/files/data"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="st">"C:\\Users\\Michelle\\Downloads"</span><span class="op">)</span></span></code></pre></div>
<p>A <strong>better idea is to use relative paths with the <a href="https://github.com/r-lib/here" class="external-link">here</a> R package</strong>.</p>
<ul>
<li>It will recognize the top-level directory of a Git repo and supports
building all paths relative to that.</li>
<li>For more on project-oriented workflow suggestions, read <a href="https://www.tidyverse.org/articles/2017/12/workflow-vs-script/" class="external-link">this
post</a> from Jenny Bryan.</li>
</ul>
<div class="section level4">
<h4 id="the-here-package">The <code>here</code> package<a class="anchor" aria-label="anchor" href="#the-here-package"></a>
</h4>
<p>Let’s try using the <code>here</code> package.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/Users/stephaniehicks/Documents/github/teaching/jhuquantneuro2022"</span></span></code></pre>
<p>This function creates a path unique to my computer, but will also be
unique to yours.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "_pkgdown.yml"            "data"                   </span></span>
<span><span class="co">##  [3] "DESCRIPTION"             "docs"                   </span></span>
<span><span class="co">##  [5] "jhuquantneuro2022.Rproj" "man"                    </span></span>
<span><span class="co">##  [7] "NAMESPACE"               "R"                      </span></span>
<span><span class="co">##  [9] "README.md"               "vignettes"</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "asthma.rda"         "chicago.rds"        "spotify_songs.RDS" </span></span>
<span><span class="co">## [4] "team_standings.csv"</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"team_standings.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## character(0)</span></span></code></pre>
<p>Now we see that using the <code><a href="https://here.r-lib.org//reference/here.html" class="external-link">here::here()</a></code> function is a
<em>relative</em> path (relative to the <code>.Rproj</code> file in our
<code>jhuquantneuro2022</code> folder.</p>
<p>Next, let’s use the <code>here</code> package to read in some data
with the <code>readr</code> package.</p>
</div>
</div>
<div class="section level3">
<h3 id="the-readr-package">The <code>readr</code> package<a class="anchor" aria-label="anchor" href="#the-readr-package"></a>
</h3>
<p>The <code>readr</code> package is recently developed by posit
(formerly RStudio) to deal with reading in large flat files quickly. The
package provides replacements for functions like
<code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table()</a></code> and <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code>. The analogous
functions in <code>readr</code> are <code><a href="https://readr.tidyverse.org/reference/read_table.html" class="external-link">read_table()</a></code> and
<code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv()</a></code>.</p>
<p>These functions are often <em>much</em> faster than their base R
analogues and provide a few other nice features such as progress
meters.</p>
<p>For example, the package includes a variety of functions in the
<code>read_*()</code> family that allow you to read in data from
different formats of flat files. The following table gives a guide to
several functions in the <code>read_*()</code> family.</p>
<table class="table">
<thead><tr class="header">
<th align="left">
<code>readr</code> function</th>
<th align="left">Use</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv()</a></code></td>
<td align="left">Reads comma-separated file</td>
</tr>
<tr class="even">
<td align="left"><code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv2()</a></code></td>
<td align="left">Reads semicolon-separated file</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv()</a></code></td>
<td align="left">Reads tab-separated file</td>
</tr>
<tr class="even">
<td align="left"><code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_delim()</a></code></td>
<td align="left">General function for reading delimited files</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="https://readr.tidyverse.org/reference/read_fwf.html" class="external-link">read_fwf()</a></code></td>
<td align="left">Reads fixed width files</td>
</tr>
<tr class="even">
<td align="left"><code><a href="https://readr.tidyverse.org/reference/read_log.html" class="external-link">read_log()</a></code></td>
<td align="left">Reads log files</td>
</tr>
</tbody>
</table>
<p>A typical call to <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv()</a></code> will look as follows.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="va">teams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"team_standings.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">teams</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 32 × 2</span></span></span>
<span><span class="co">##    Standing Team       </span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>        1 Spain      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>        2 Netherlands</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>        3 Germany    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>        4 Uruguay    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>        5 Argentina  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>        6 Brazil     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>        7 Ghana      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>        8 Paraguay   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>        9 Japan      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>       10 Chile      </span></span>
<span><span class="co">## <span style="color: #949494;"># … with 22 more rows</span></span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="data-frames-and-tibbles">Data frames and tibbles<a class="anchor" aria-label="anchor" href="#data-frames-and-tibbles"></a>
</h2>
<p>The <strong>data frame</strong> (or <code>data.frame</code>) is a
<strong>key data structure</strong> in statistics and in R.</p>
<p>The basic structure of a data frame is that there is <strong>one
observation per row and each column represents a variable, a measure,
feature, or characteristic of that observation</strong>.</p>
<p>Given the importance of managing data frames, it is <strong>important
that we have good tools for dealing with them.</strong></p>
<p>For example, <strong>operations</strong> like filtering rows,
re-ordering rows, and selecting columns, can often be tedious operations
in R whose syntax is not very intuitive. The <code>dplyr</code> package
in the <code>tidyverse</code> is designed to mitigate a lot of these
problems and to provide a highly optimized set of routines specifically
for dealing with data frames.</p>
<div class="section level3">
<h3 id="tibbles">Tibbles<a class="anchor" aria-label="anchor" href="#tibbles"></a>
</h3>
<p>Another type of data structure that we need to discuss is called the
<strong>tibble</strong>! It’s best to think of tibbles as an updated and
stylish version of the <code>data.frame</code>.</p>
<p>Tibbles are what tidyverse packages work with most seamlessly. Now,
that <strong>does not mean tidyverse packages <em>require</em>
tibbles</strong>.</p>
<p>In fact, they still work with <code>data.frames</code>, but the more
you work with tidyverse and tidyverse-adjacent packages, the more you
will see the advantages of using tibbles.</p>
<p>Before we go any further, tibbles <em>are</em> data frames, but they
have some new bells and whistles to make your life easier.</p>
</div>
<div class="section level3">
<h3 id="how-tibbles-differ-from-data-frame">How tibbles differ from <code>data.frame</code><a class="anchor" aria-label="anchor" href="#how-tibbles-differ-from-data-frame"></a>
</h3>
<p>There are a number of differences between tibbles and
<code>data.frames</code>.</p>
<p><strong>Note</strong>: To see a full vignette about tibbles and how
they differ from data.frame, you will want to execute
<code><a href="https://tibble.tidyverse.org/articles/tibble.html" class="external-link">vignette("tibble")</a></code> and read through that vignette.</p>
<p>We will summarize some of the most important points here:</p>
<ul>
<li>
<strong>Input type remains unchanged</strong> -
<code>data.frame</code> is notorious for treating strings as factors;
this will not happen with tibbles</li>
<li>
<strong>Variable names remain unchanged</strong> - In base R,
creating <code>data.frames</code> will remove spaces from names,
converting them to periods or add “x” before numeric column names.
Creating tibbles will not change variable (column) names.</li>
<li>
<strong>There are no <code><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names()</a></code> for a tibble</strong>
- Tidy data requires that variables be stored in a consistent way,
removing the need for row names.</li>
<li>
<strong>Tibbles print first ten rows and columns that fit on one
screen</strong> - Printing a tibble to screen will never print the
entire huge data frame out. By default, it just shows what fits to your
screen.</li>
</ul>
</div>
<div class="section level3">
<h3 id="as_tibble">
<code>as_tibble()</code><a class="anchor" aria-label="anchor" href="#as_tibble"></a>
</h3>
<p>Since many packages use the historical <code>data.frame</code> from
base R, you will often find yourself in the situation that you have a
<code>data.frame</code> and want to convert that <code>data.frame</code>
to a <code>tibbl</code>e.</p>
<p>To do so, the <code><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble()</a></code> function is exactly what you
are looking for.</p>
<p>For the example, here we use a dataset (<code>chicago.rds</code>)
containing air pollution and temperature data for the city of Chicago in
the U.S.</p>
<p>The dataset is available in the <code>/data</code> repository. You
can load the data into R using the <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS()</a></code> function.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="va">chicago</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"chicago.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>You can see some basic characteristics of the dataset with the
<code><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim()</a></code> and <code><a href="https://rdrr.io/r/utils/str.html" class="external-link">str()</a></code> functions.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">chicago</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6940    8</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">chicago</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    6940 obs. of  8 variables:</span></span>
<span><span class="co">##  $ city      : chr  "chic" "chic" "chic" "chic" ...</span></span>
<span><span class="co">##  $ tmpd      : num  31.5 33 33 29 32 40 34.5 29 26.5 32.5 ...</span></span>
<span><span class="co">##  $ dptp      : num  31.5 29.9 27.4 28.6 28.9 ...</span></span>
<span><span class="co">##  $ date      : Date, format: "1987-01-01" "1987-01-02" ...</span></span>
<span><span class="co">##  $ pm25tmean2: num  NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##  $ pm10tmean2: num  34 NA 34.2 47 NA ...</span></span>
<span><span class="co">##  $ o3tmean2  : num  4.25 3.3 3.33 4.38 4.75 ...</span></span>
<span><span class="co">##  $ no2tmean2 : num  20 23.2 23.8 30.4 30.3 ...</span></span></code></pre>
<p>We see this data structure is a <code>data.frame</code> with 6940
observations and 8 variables.</p>
<p>To convert this <code>data.frame</code> to a tibble you would use the
following:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu">as_tibble</span><span class="op">(</span><span class="va">chicago</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## tibble [6,940 × 8] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ city      : chr [1:6940] "chic" "chic" "chic" "chic" ...</span></span>
<span><span class="co">##  $ tmpd      : num [1:6940] 31.5 33 33 29 32 40 34.5 29 26.5 32.5 ...</span></span>
<span><span class="co">##  $ dptp      : num [1:6940] 31.5 29.9 27.4 28.6 28.9 ...</span></span>
<span><span class="co">##  $ date      : Date[1:6940], format: "1987-01-01" "1987-01-02" ...</span></span>
<span><span class="co">##  $ pm25tmean2: num [1:6940] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##  $ pm10tmean2: num [1:6940] 34 NA 34.2 47 NA ...</span></span>
<span><span class="co">##  $ o3tmean2  : num [1:6940] 4.25 3.3 3.33 4.38 4.75 ...</span></span>
<span><span class="co">##  $ no2tmean2 : num [1:6940] 20 23.2 23.8 30.4 30.3 ...</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="the-dplyr-package">The <code>dplyr</code> Package<a class="anchor" aria-label="anchor" href="#the-dplyr-package"></a>
</h2>
<p>The <code>dplyr</code> package was developed by Posit (formely
RStudio) and is <strong>an optimized and distilled</strong> version of
the older <code>plyr</code> <strong>package for data manipulation or
wrangling</strong>.</p>
<p>The <code>dplyr</code> package does not provide any “new”
functionality to R per se, in the sense that everything
<code>dplyr</code> does could already be done with base R, but it
<strong>greatly</strong> simplifies existing functionality in R.</p>
<p>One important contribution of the <code>dplyr</code> package is that
it <strong>provides a “grammar” (in particular, verbs) for data
manipulation and for operating on data frames</strong>.</p>
<p>With this grammar, you can sensibly communicate what it is that you
are doing to a data frame that other people can understand (assuming
they also know the grammar). This is useful because it <strong>provides
an abstraction for data manipulation that previously did not
exist</strong>.</p>
<p>Another useful contribution is that the <code>dplyr</code> functions
are <strong>very</strong> fast, as many key operations are coded in
C++.</p>
<div class="section level3">
<h3 id="dplyr-grammar">
<code>dplyr</code> grammar<a class="anchor" aria-label="anchor" href="#dplyr-grammar"></a>
</h3>
<p>Some of the key “verbs” provided by the <code>dplyr</code> package
are</p>
<ul>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code>: return a subset of the columns of a data
frame, using a flexible notation</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code>: extract a subset of rows from a data frame
based on logical conditions</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange()</a></code>: reorder rows of a data frame</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename()</a></code>: rename variables in a data frame</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code>: add new variables/columns or transform
existing variables</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise()</a></code> / <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code>: generate
summary statistics of different variables in the data frame, possibly
within strata</p></li>
<li><p><code>%&gt;%</code>: the “pipe” operator is used to connect
multiple verb actions together into a pipeline</p></li>
</ul>
<p><strong>Note</strong>: The <code>dplyr</code> package as a number of
its own data types that it takes advantage of.</p>
<p>For example, there is a handy <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method that
prevents you from printing a lot of data to the console. Most of the
time, these additional data types are transparent to the user and do not
need to be worried about.</p>
</div>
</div>
<div class="section level2">
<h2 id="dplyr-functions">
<code>dplyr</code> functions<a class="anchor" aria-label="anchor" href="#dplyr-functions"></a>
</h2>
<p>All of the functions that we will discuss here will have a few common
characteristics. In particular,</p>
<ol style="list-style-type: decimal">
<li><p>The <strong>first argument</strong> is a data frame type
object.</p></li>
<li><p>The <strong>subsequent arguments</strong> describe what to do
with the data frame specified in the first argument, and you can refer
to columns in the data frame directly (without using the <code>$</code>
operator, just use the column names).</p></li>
<li><p>The <strong>return result</strong> of a function is a new data
frame.</p></li>
<li><p>Data frames must be <strong>properly formatted</strong> and
annotated for this to all be useful. In particular, the data must be <a href="http://www.jstatsoft.org/v59/i10/paper" class="external-link">tidy</a>. In short, there
should be one observation per row, and each column should represent a
feature or characteristic of that observation.</p></li>
</ol>
<div class="section level3">
<h3 id="dplyr-installation">
<code>dplyr</code> installation<a class="anchor" aria-label="anchor" href="#dplyr-installation"></a>
</h3>
<p>The <code>dplyr</code> package is installed when you install and load
the <code>tidyverse</code> meta-package.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<p>You may get some warnings when the package is loaded because there
are functions in the <code>dplyr</code> package that have the same name
as functions in other packages. For now you can ignore the warnings.</p>
</div>
<div class="section level3">
<h3 id="select">
<code>select()</code><a class="anchor" aria-label="anchor" href="#select"></a>
</h3>
<p>We will continue to use the <code>chicago</code> dataset containing
air pollution and temperature data.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chicago</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">chicago</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">chicago</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## tibble [6,940 × 8] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ city      : chr [1:6940] "chic" "chic" "chic" "chic" ...</span></span>
<span><span class="co">##  $ tmpd      : num [1:6940] 31.5 33 33 29 32 40 34.5 29 26.5 32.5 ...</span></span>
<span><span class="co">##  $ dptp      : num [1:6940] 31.5 29.9 27.4 28.6 28.9 ...</span></span>
<span><span class="co">##  $ date      : Date[1:6940], format: "1987-01-01" "1987-01-02" ...</span></span>
<span><span class="co">##  $ pm25tmean2: num [1:6940] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##  $ pm10tmean2: num [1:6940] 34 NA 34.2 47 NA ...</span></span>
<span><span class="co">##  $ o3tmean2  : num [1:6940] 4.25 3.3 3.33 4.38 4.75 ...</span></span>
<span><span class="co">##  $ no2tmean2 : num [1:6940] 20 23.2 23.8 30.4 30.3 ...</span></span></code></pre>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> function can be used to <strong>select
columns of a data frame</strong> that you want to focus on.</p>
<div class="section level4">
<h4 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<p>Suppose we wanted to take the first 3 columns only. There are a few
ways to do this.</p>
<p>We could for example use numerical indices:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">chicago</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "city" "tmpd" "dptp"</span></span></code></pre>
<p>But we can also use the names directly:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="va">city</span><span class="op">:</span><span class="va">dptp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">subset</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">##   city   tmpd  dptp</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> chic   31.5  31.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> chic   33    29.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> chic   33    27.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> chic   29    28.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> chic   32    28.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> chic   40    35.1</span></span></code></pre>
<p><strong>Note</strong>: The <code>:</code> normally cannot be used
with names or strings, but inside the <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> function you
can use it to specify a range of variable names.</p>
<p>You can also <strong>omit</strong> variables using the
<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> function by using the negative sign. With
<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> you can do</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="op">-</span><span class="op">(</span><span class="va">city</span><span class="op">:</span><span class="va">dptp</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>which indicates that we should include every variable <em>except</em>
the variables <code>city</code> through <code>dptp</code>. The
equivalent code in base R would be</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="st">"city"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">chicago</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="st">"dptp"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">chicago</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">chicago</span><span class="op">[</span>, <span class="op">-</span><span class="op">(</span><span class="va">i</span><span class="op">:</span><span class="va">j</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Not super intuitive, right?</p>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> function also allows a special syntax that
allows you to specify variable names based on patterns. So, for example,
if you wanted to keep every variable that ends with a “2”, we could
do</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="st">"2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">subset</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## tibble [6,940 × 4] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ pm25tmean2: num [1:6940] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##  $ pm10tmean2: num [1:6940] 34 NA 34.2 47 NA ...</span></span>
<span><span class="co">##  $ o3tmean2  : num [1:6940] 4.25 3.3 3.33 4.38 4.75 ...</span></span>
<span><span class="co">##  $ no2tmean2 : num [1:6940] 20 23.2 23.8 30.4 30.3 ...</span></span></code></pre>
<p>Or if we wanted to keep every variable that starts with a “d”, we
could do</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"d"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">subset</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## tibble [6,940 × 2] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ dptp: num [1:6940] 31.5 29.9 27.4 28.6 28.9 ...</span></span>
<span><span class="co">##  $ date: Date[1:6940], format: "1987-01-01" "1987-01-02" ...</span></span></code></pre>
<p>You can also use more general regular expressions if necessary. See
the help page (<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">?select</a></code>) for more details.</p>
</div>
</div>
<div class="section level3">
<h3 id="filter">
<code>filter()</code><a class="anchor" aria-label="anchor" href="#filter"></a>
</h3>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> function is used to <strong>extract subsets
of rows</strong> from a data frame. This function is similar to the
existing <code><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset()</a></code> function in R but is quite a bit faster
in my experience.</p>
<div class="section level4">
<h4 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<p>Suppose we wanted to extract the rows of the <code>chicago</code>
data frame where the levels of PM2.5 are greater than 30 (which is a
reasonably high level), we could do</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chic.f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="va">pm25tmean2</span> <span class="op">&gt;</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">chic.f</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## tibble [194 × 8] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ city      : chr [1:194] "chic" "chic" "chic" "chic" ...</span></span>
<span><span class="co">##  $ tmpd      : num [1:194] 23 28 55 59 57 57 75 61 73 78 ...</span></span>
<span><span class="co">##  $ dptp      : num [1:194] 21.9 25.8 51.3 53.7 52 56 65.8 59 60.3 67.1 ...</span></span>
<span><span class="co">##  $ date      : Date[1:194], format: "1998-01-17" "1998-01-23" ...</span></span>
<span><span class="co">##  $ pm25tmean2: num [1:194] 38.1 34 39.4 35.4 33.3 ...</span></span>
<span><span class="co">##  $ pm10tmean2: num [1:194] 32.5 38.7 34 28.5 35 ...</span></span>
<span><span class="co">##  $ o3tmean2  : num [1:194] 3.18 1.75 10.79 14.3 20.66 ...</span></span>
<span><span class="co">##  $ no2tmean2 : num [1:194] 25.3 29.4 25.3 31.4 26.8 ...</span></span></code></pre>
<p>You can see that there are now only 194 rows in the data frame and
the distribution of the <code>pm25tmean2</code> values is.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">chic.f</span><span class="op">$</span><span class="va">pm25tmean2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##   30.05   32.12   35.04   36.63   39.53   61.50</span></span></code></pre>
<p>We can place an arbitrarily complex logical sequence inside of
<code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code>, so we could for example extract the rows where
PM2.5 is greater than 30 <em>and</em> temperature is greater than 80
degrees Fahrenheit.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chic.f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="va">pm25tmean2</span> <span class="op">&gt;</span> <span class="fl">30</span> <span class="op">&amp;</span> <span class="va">tmpd</span> <span class="op">&gt;</span> <span class="fl">80</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chic.f</span>, <span class="va">date</span>, <span class="va">tmpd</span>, <span class="va">pm25tmean2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 17 × 3</span></span></span>
<span><span class="co">##    date        tmpd pm25tmean2</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 1998-08-23    81       39.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 1998-09-06    81       31.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 2001-07-20    82       32.3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 2001-08-01    84       43.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 2001-08-08    85       38.8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 2001-08-09    84       38.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 2002-06-20    82       33  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 2002-06-23    82       42.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 2002-07-08    81       33.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 2002-07-18    82       38.8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> 2003-06-25    82       33.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> 2003-07-04    84       32.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> 2005-06-24    86       31.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> 2005-06-27    82       51.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> 2005-06-28    85       31.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> 2005-07-17    84       32.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span> 2005-08-03    84       37.9</span></span></code></pre>
<p>Now there are only 17 observations where both of those conditions are
met.</p>
<p>Other logical operators you should be aware of include:</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="37%">
<col width="46%">
</colgroup>
<thead><tr class="header">
<th align="right">Operator</th>
<th align="right">Meaning</th>
<th align="right">Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right"><code>==</code></td>
<td align="right">Equals</td>
<td align="right"><code>city == chic</code></td>
</tr>
<tr class="even">
<td align="right"><code>!=</code></td>
<td align="right">Does not equal</td>
<td align="right"><code>city != chic</code></td>
</tr>
<tr class="odd">
<td align="right"><code>&gt;</code></td>
<td align="right">Greater than</td>
<td align="right"><code>tmpd &gt; 32.0</code></td>
</tr>
<tr class="even">
<td align="right"><code>&gt;=</code></td>
<td align="right">Greater than or equal to</td>
<td align="right"><code>tmpd &gt;- 32.0</code></td>
</tr>
<tr class="odd">
<td align="right"><code>&lt;</code></td>
<td align="right">Less than</td>
<td align="right"><code>tmpd &lt; 32.0</code></td>
</tr>
<tr class="even">
<td align="right"><code>&lt;=</code></td>
<td align="right">Less than or equal to</td>
<td align="right"><code>tmpd &lt;= 32.0</code></td>
</tr>
<tr class="odd">
<td align="right"><code>%in%</code></td>
<td align="right">Included in</td>
<td align="right"><code>city %in% c("chic", "bmore")</code></td>
</tr>
<tr class="even">
<td align="right"><code><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na()</a></code></td>
<td align="right">Is a missing value</td>
<td align="right"><code>is.na(pm10tmean2)</code></td>
</tr>
</tbody>
</table>
<p><strong>Note</strong>: If you are ever unsure of how to write a
logical statement, but know how to write its opposite, you can use the
<code>!</code> operator to negate the whole statement.</p>
<p>A common use of this is to identify observations with non-missing
data (e.g., <code>!(is.na(pm10tmean2))</code>).</p>
</div>
</div>
<div class="section level3">
<h3 id="arrange">
<code>arrange()</code><a class="anchor" aria-label="anchor" href="#arrange"></a>
</h3>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange()</a></code> function is used to <strong>reorder
rows</strong> of a data frame according to one of the variables/columns.
Reordering rows of a data frame (while preserving corresponding order of
other columns) is normally a pain to do in R. The <code><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange()</a></code>
function simplifies the process quite a bit.</p>
<p>Here we can order the rows of the data frame by date, so that the
first row is the earliest (oldest) observation and the last row is the
latest (most recent) observation.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chicago</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="va">date</span><span class="op">)</span></span></code></pre></div>
<p>We can now check the first few rows</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="va">date</span>, <span class="va">pm25tmean2</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">##   date       pm25tmean2</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1987-01-01         <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 1987-01-02         <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 1987-01-03         <span style="color: #BB0000;">NA</span></span></span></code></pre>
<p>and the last few rows.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="va">date</span>, <span class="va">pm25tmean2</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">##   date       pm25tmean2</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 2005-12-29       7.45</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2005-12-30      15.1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2005-12-31      15</span></span></code></pre>
<p>Columns can be arranged in descending order too by useing the special
<code><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc()</a></code> operator.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chicago</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Looking at the first three and last three rows shows the dates in
descending order.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="va">date</span>, <span class="va">pm25tmean2</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">##   date       pm25tmean2</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 2005-12-31      15   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2005-12-30      15.1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2005-12-29       7.45</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="va">date</span>, <span class="va">pm25tmean2</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">##   date       pm25tmean2</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1987-01-03         <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 1987-01-02         <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 1987-01-01         <span style="color: #BB0000;">NA</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="rename">
<code>rename()</code><a class="anchor" aria-label="anchor" href="#rename"></a>
</h3>
<p><strong>Renaming a variable</strong> in a data frame in R is
surprisingly hard to do! The <code><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename()</a></code> function is designed
to make this process easier.</p>
<p>Here you can see the names of the first five variables in the
<code>chicago</code> data frame.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">chicago</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">##   city   tmpd  dptp date       pm25tmean2</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> chic     35  30.1 2005-12-31      15   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> chic     36  31   2005-12-30      15.1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> chic     35  29.4 2005-12-29       7.45</span></span></code></pre>
<p>The <code>dptp</code> column is supposed to represent the dew point
temperature and the <code>pm25tmean2</code> column provides the PM2.5
data.</p>
<p>However, these names are pretty obscure or awkward and probably be
renamed to something more sensible.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chicago</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="va">chicago</span>, dewpoint <span class="op">=</span> <span class="va">dptp</span>, pm25 <span class="op">=</span> <span class="va">pm25tmean2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">chicago</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">##   city   tmpd dewpoint date        pm25</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> chic     35     30.1 2005-12-31 15   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> chic     36     31   2005-12-30 15.1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> chic     35     29.4 2005-12-29  7.45</span></span></code></pre>
<p>The syntax inside the <code><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename()</a></code> function is to have the
new name on the left-hand side of the <code>=</code> sign and the old
name on the right-hand side.</p>
</div>
<div class="section level3">
<h3 id="mutate">
<code>mutate()</code><a class="anchor" aria-label="anchor" href="#mutate"></a>
</h3>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> function exists to <strong>compute
transformations of variables</strong> in a data frame. Often, you want
to create new variables that are derived from existing variables and
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> provides a clean interface for doing that.</p>
<p>For example, with air pollution data, we often want to
<em>detrend</em> the data by subtracting the mean from the data.</p>
<ul>
<li>That way we can look at whether a given day’s air pollution level is
higher than or less than average (as opposed to looking at its absolute
level).</li>
</ul>
<p>Here, we create a <code>pm25detrend</code> variable that subtracts
the mean from the <code>pm25</code> variable.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chicago</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">chicago</span>, pm25detrend <span class="op">=</span> <span class="va">pm25</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pm25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">chicago</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 9</span></span></span>
<span><span class="co">##   city   tmpd dewpoint date        pm25 pm10tmean2 o3tmean2 no2tmean2 pm25detr…¹</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> chic     35     30.1 2005-12-31 15          23.5     2.53      13.2      -<span style="color: #BB0000;">1.23</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> chic     36     31   2005-12-30 15.1        19.2     3.03      22.8      -<span style="color: #BB0000;">1.17</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> chic     35     29.4 2005-12-29  7.45       23.5     6.79      20.0      -<span style="color: #BB0000;">8.78</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> chic     37     34.5 2005-12-28 17.8        27.5     3.26      19.3       1.52</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> chic     40     33.6 2005-12-27 23.6        27       4.47      23.5       7.33</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> chic     35     29.6 2005-12-26  8.4         8.5    14.0       16.8      -<span style="color: #BB0000;">7.83</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable name ¹​pm25detrend</span></span></span></code></pre>
<p>There is also the related <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">transmute()</a></code> function, which
does the same thing as <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> but then <strong>drops all
non-transformed variables</strong>.</p>
<p>Here, we de-trend the PM10 and ozone (O3) variables.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">transmute</a></span><span class="op">(</span><span class="va">chicago</span>, </span>
<span>               pm10detrend <span class="op">=</span> <span class="va">pm10tmean2</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pm10tmean2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>               o3detrend <span class="op">=</span> <span class="va">o3tmean2</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">o3tmean2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">##   pm10detrend o3detrend</span></span>
<span><span class="co">##         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>      -<span style="color: #BB0000;">10.4</span>     -<span style="color: #BB0000;">16.9</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>      -<span style="color: #BB0000;">14.7</span>     -<span style="color: #BB0000;">16.4</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>      -<span style="color: #BB0000;">10.4</span>     -<span style="color: #BB0000;">12.6</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>       -<span style="color: #BB0000;">6.40</span>    -<span style="color: #BB0000;">16.2</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>       -<span style="color: #BB0000;">6.90</span>    -<span style="color: #BB0000;">15.0</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>      -<span style="color: #BB0000;">25.4</span>      -<span style="color: #BB0000;">5.39</span></span></span></code></pre>
<p>Note that there are only two columns in the transmuted data
frame.</p>
</div>
<div class="section level3">
<h3 id="group_by">
<code>group_by()</code><a class="anchor" aria-label="anchor" href="#group_by"></a>
</h3>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code> function is used to <strong>generate
summary statistics</strong> from the data frame within strata defined by
a variable.</p>
<p>For example, in this air pollution dataset, you might want to know
what the average annual level of PM2.5 is?</p>
<p>So the stratum is the year, and that is something we can derive from
the <code>date</code> variable.</p>
<p><strong>In conjunction</strong> with the <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code>
function, we often use the <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code> function (or
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise()</a></code> for some parts of the world).</p>
<p><strong>Note</strong>: The <strong>general operation</strong> here is
a combination of</p>
<ol style="list-style-type: decimal">
<li>Splitting a data frame into separate pieces defined by a variable or
group of variables (<code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code>)</li>
<li>Then, applying a summary function across those subsets
(<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code>)</li>
</ol>
<div class="section level4">
<h4 id="example-2">Example<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h4>
<p>First, we can create a <code>year</code> variable using
<code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt()</a></code>.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chicago</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">chicago</span>, year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">$</span><span class="va">year</span> <span class="op">+</span> <span class="fl">1900</span><span class="op">)</span></span></code></pre></div>
<p>Now we can create a separate data frame that splits the original data
frame by year.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">chicago</span>, <span class="va">year</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we compute summary statistics for each year in the data
frame with the <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code> function.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="va">years</span>, </span>
<span>          pm25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pm25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>          o3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">o3tmean2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>          no2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">no2tmean2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 19 × 4</span></span></span>
<span><span class="co">##     year  pm25    o3   no2</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">1</span>987 <span style="color: #BB0000;">NaN</span>    63.0  23.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">1</span>988 <span style="color: #BB0000;">NaN</span>    61.7  24.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">1</span>989 <span style="color: #BB0000;">NaN</span>    59.7  26.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">1</span>990 <span style="color: #BB0000;">NaN</span>    52.2  22.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">1</span>991 <span style="color: #BB0000;">NaN</span>    63.1  21.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">1</span>992 <span style="color: #BB0000;">NaN</span>    50.8  24.8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">1</span>993 <span style="color: #BB0000;">NaN</span>    44.3  25.8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">1</span>994 <span style="color: #BB0000;">NaN</span>    52.2  28.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>995 <span style="color: #BB0000;">NaN</span>    66.6  27.3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">1</span>996 <span style="color: #BB0000;">NaN</span>    58.4  26.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>  <span style="text-decoration: underline;">1</span>997 <span style="color: #BB0000;">NaN</span>    56.5  25.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>  <span style="text-decoration: underline;">1</span>998  18.3  50.7  24.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span>  <span style="text-decoration: underline;">1</span>999  18.5  57.5  24.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span>  <span style="text-decoration: underline;">2</span>000  16.9  55.8  23.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span>  <span style="text-decoration: underline;">2</span>001  16.9  51.8  25.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span>  <span style="text-decoration: underline;">2</span>002  15.3  54.9  22.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span>  <span style="text-decoration: underline;">2</span>003  15.2  56.2  24.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span>  <span style="text-decoration: underline;">2</span>004  14.6  44.5  23.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">19</span>  <span style="text-decoration: underline;">2</span>005  16.2  58.8  22.6</span></span></code></pre>
<p><code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code> returns a data frame with <code>year</code>
as the first column, and then the annual summary statistics of
<code>pm25</code>, <code>o3</code>, and <code>no2</code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="section">
<code>%&gt;%</code><a class="anchor" aria-label="anchor" href="#section"></a>
</h3>
<p>The pipeline operator <code>%&gt;%</code> is very handy for
<strong>stringing together multiple <code>dplyr</code> functions in a
sequence of operations</strong>.</p>
<p>Notice above that every time we wanted to apply more than one
function, the sequence gets buried in a sequence of nested function
calls that is difficult to read, i.e.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">third</span><span class="op">(</span><span class="fu">second</span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This <strong>nesting is not a natural way</strong> to think about a
sequence of operations.</p>
<p>The <code>%&gt;%</code> operator allows you to string operations in a
left-to-right fashion, i.e.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">second</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">third</span></span></code></pre></div>
<div class="section level4">
<h4 id="example-3">Example<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h4>
<p>Take the example that we just did in the last section, but here use
the pipe operator in a single expression.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">chicago</span>, year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">$</span><span class="va">year</span> <span class="op">+</span> <span class="fl">1900</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>    </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="va">years</span>, pm25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pm25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>          o3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">o3tmean2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>          no2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">no2tmean2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 131,860 × 12</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   year [19]</span></span></span>
<span><span class="co">##     year city   tmpd dewpoint date        pm25 pm10tme…¹ o3tme…² no2tm…³ pm25d…⁴</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>005 chic     35     30.1 2005-12-31  16.2      23.5    2.53    13.2   -<span style="color: #BB0000;">1.23</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>005 chic     36     31   2005-12-30  16.2      19.2    3.03    22.8   -<span style="color: #BB0000;">1.17</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>005 chic     35     29.4 2005-12-29  16.2      23.5    6.79    20.0   -<span style="color: #BB0000;">8.78</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>005 chic     37     34.5 2005-12-28  16.2      27.5    3.26    19.3    1.52</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>005 chic     40     33.6 2005-12-27  16.2      27      4.47    23.5    7.33</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>005 chic     35     29.6 2005-12-26  16.2       8.5   14.0     16.8   -<span style="color: #BB0000;">7.83</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>005 chic     35     32.1 2005-12-25  16.2       8     14.4     13.8   -<span style="color: #BB0000;">9.53</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>005 chic     37     35.2 2005-12-24  16.2      25.2    1.77    32.0   14.5 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>005 chic     41     32.6 2005-12-23  16.2      34.5    6.91    29.1   16.7 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>005 chic     22     23.3 2005-12-22  16.2      42.5    5.39    33.7   20.4 </span></span>
<span><span class="co">## <span style="color: #949494;"># … with 131,850 more rows, 2 more variables: o3 &lt;dbl&gt;, no2 &lt;dbl&gt;, and</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   abbreviated variable names ¹​pm10tmean2, ²​o3tmean2, ³​no2tmean2, ⁴​pm25detrend</span></span></span></code></pre>
<p><strong>Note</strong>: In the above code, I pass the
<code>chicago</code> data frame to the first call to
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code>, but then afterwards I do not have to pass the
first argument to <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code> or
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code>.</p>
<ul>
<li>Once you travel down the pipeline with <code>%&gt;%</code>, the
first argument is taken to be the output of the previous element in the
pipeline.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="slice_">
<code>slice_*()</code><a class="anchor" aria-label="anchor" href="#slice_"></a>
</h3>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample()</a></code> function of the <code>dplyr</code>
package will allow you to see a <strong>sample of random rows</strong>
in random order.</p>
<p>The number of rows to show is specified by the <code>n</code>
argument.</p>
<ul>
<li>This can be useful if you <strong>do not want to print the entire
tibble</strong>, but you want to get a greater sense of the values.</li>
<li>This is a <strong>good option for data analysis reports</strong>,
where printing the entire tibble would not be appropriate if the tibble
is quite large.</li>
</ul>
<div class="section level4">
<h4 id="example-4">Example<a class="anchor" aria-label="anchor" href="#example-4"></a>
</h4>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span><span class="va">chicago</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 10</span></span></span>
<span><span class="co">##    city   tmpd dewpoint date        pm25 pm10tme…¹ o3tme…² no2tm…³ pm25d…⁴  year</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> chic   42       33.5 2003-04-17  12.6      22     23.3     23.2   -<span style="color: #BB0000;">3.58</span>  <span style="text-decoration: underline;">2</span>003</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> chic   46.5     36.2 1993-11-23  <span style="color: #BB0000;">NA</span>        27      2.46    35.6   <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">1</span>993</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> chic   45       37.7 1998-12-01  17.8      22.8    3.64    25.0    1.62  <span style="text-decoration: underline;">1</span>998</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> chic   57       39.8 1999-09-22  <span style="color: #BB0000;">NA</span>        30     13.7     33.8   <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">1</span>999</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> chic   75       61.6 2005-07-05  <span style="color: #BB0000;">NA</span>        22.5   30.3     13.4   <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">2</span>005</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> chic   44       35.7 2003-10-29  <span style="color: #BB0000;">NA</span>        18.5    7.26    16.5   <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">2</span>003</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> chic   48.5     39.5 1987-03-06  <span style="color: #BB0000;">NA</span>        76      9.08    47.2   <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">1</span>987</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> chic   54       38.4 2003-04-02  29.8      51     19.7     31.8   13.6   <span style="text-decoration: underline;">2</span>003</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> chic   58.5     46.4 1995-09-09  <span style="color: #BB0000;">NA</span>        13     23.3     17.6   <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">1</span>995</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> chic   56       38.9 1999-09-30   9.1      29.5   13.5     26.3   -<span style="color: #BB0000;">7.13</span>  <span style="text-decoration: underline;">1</span>999</span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable names ¹​pm10tmean2, ²​o3tmean2, ³​no2tmean2,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ⁴​pm25detrend</span></span></span></code></pre>
<p>You can also use <code><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head()</a></code> or
<code><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_tail()</a></code> to take a look at the top rows or bottom rows
of your tibble. Again the number of rows can be specified with the
<code>n</code> argument.</p>
<p>This will show the first 5 rows.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span><span class="va">chicago</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 10</span></span></span>
<span><span class="co">##   city   tmpd dewpoint date        pm25 pm10tmean2 o3tme…¹ no2tm…² pm25d…³  year</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> chic     35     30.1 2005-12-31 15          23.5    2.53    13.2   -<span style="color: #BB0000;">1.23</span>  <span style="text-decoration: underline;">2</span>005</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> chic     36     31   2005-12-30 15.1        19.2    3.03    22.8   -<span style="color: #BB0000;">1.17</span>  <span style="text-decoration: underline;">2</span>005</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> chic     35     29.4 2005-12-29  7.45       23.5    6.79    20.0   -<span style="color: #BB0000;">8.78</span>  <span style="text-decoration: underline;">2</span>005</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> chic     37     34.5 2005-12-28 17.8        27.5    3.26    19.3    1.52  <span style="text-decoration: underline;">2</span>005</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> chic     40     33.6 2005-12-27 23.6        27      4.47    23.5    7.33  <span style="text-decoration: underline;">2</span>005</span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable names ¹​o3tmean2, ²​no2tmean2, ³​pm25detrend</span></span></span></code></pre>
<p>This will show the last 5 rows.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_tail</a></span><span class="op">(</span><span class="va">chicago</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 10</span></span></span>
<span><span class="co">##   city   tmpd dewpoint date        pm25 pm10tmean2 o3tme…¹ no2tm…² pm25d…³  year</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> chic   32       28.9 1987-01-05    <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      4.75    30.3      <span style="color: #BB0000;">NA</span>  <span style="text-decoration: underline;">1</span>987</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> chic   29       28.6 1987-01-04    <span style="color: #BB0000;">NA</span>       47      4.38    30.4      <span style="color: #BB0000;">NA</span>  <span style="text-decoration: underline;">1</span>987</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> chic   33       27.4 1987-01-03    <span style="color: #BB0000;">NA</span>       34.2    3.33    23.8      <span style="color: #BB0000;">NA</span>  <span style="text-decoration: underline;">1</span>987</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> chic   33       29.9 1987-01-02    <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      3.30    23.2      <span style="color: #BB0000;">NA</span>  <span style="text-decoration: underline;">1</span>987</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> chic   31.5     31.5 1987-01-01    <span style="color: #BB0000;">NA</span>       34      4.25    20.0      <span style="color: #BB0000;">NA</span>  <span style="text-decoration: underline;">1</span>987</span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable names ¹​o3tmean2, ²​no2tmean2, ³​pm25detrend</span></span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-ggplot2-plotting-system">The ggplot2 Plotting System<a class="anchor" aria-label="anchor" href="#the-ggplot2-plotting-system"></a>
</h2>
<p>In this section, we will get into a little more of the nitty gritty
of <strong>how <code>ggplot2</code> builds plots</strong> and how you
can customize various aspects of any plot.</p>
<div class="section level3">
<h3 id="basic-components-of-a-ggplot2-plot">Basic components of a ggplot2 plot<a class="anchor" aria-label="anchor" href="#basic-components-of-a-ggplot2-plot"></a>
</h3>
<p>A <strong><code>ggplot2</code> plot</strong> consists of a number of
<strong>key components</strong>.</p>
<ul>
<li><p>A <strong>data frame</strong>: stores all of the data that will
be displayed on the plot</p></li>
<li><p><strong>aesthetic mappings</strong>: describe how data are mapped
to color, size, shape, location</p></li>
<li><p><strong>geoms</strong>: geometric objects like points, lines,
shapes</p></li>
<li><p><strong>facets</strong>: describes how conditional/panel plots
should be constructed</p></li>
<li><p><strong>stats</strong>: statistical transformations like binning,
quantiles, smoothing</p></li>
<li><p><strong>scales</strong>: what scale an aesthetic map uses
(example: left-handed = red, right-handed = blue)</p></li>
<li><p><strong>coordinate system</strong>: describes the system in which
the locations of the geoms will be drawn</p></li>
</ul>
<p>It is <strong>essential to organize your data into a data
frame</strong> before you start with <code>ggplot2</code> (and all the
<strong>appropriate metadata</strong> so that your data frame is
self-describing and your plots will be self-documenting).</p>
<p>When <strong>building plots in <code>ggplot2</code></strong> (rather
than using <code><a href="https://ggplot2.tidyverse.org/reference/qplot.html" class="external-link">qplot()</a></code>), the <strong>“artist’s palette” model
may be the closest analogy</strong>.</p>
<p>Essentially, you start with some raw data, and then you
<strong>gradually add bits and pieces to it to create a
plot</strong>.</p>
<p>Plots are built up in layers, with the typically ordering being</p>
<ol style="list-style-type: decimal">
<li>Plot the data</li>
<li>Overlay a summary</li>
<li>Add metadata and annotation</li>
</ol>
<p>For quick exploratory plots you may not get past step 1.</p>
</div>
</div>
<div class="section level2">
<h2 id="building-up-in-layers">Building up in layers<a class="anchor" aria-label="anchor" href="#building-up-in-layers"></a>
</h2>
<p>First, we can <strong>create a <code>ggplot</code> object</strong>
that stores the dataset and the basic aesthetics for mapping the x- and
y-coordinates for the plot.</p>
<div class="section level3">
<h3 id="palmerpenguins-dataset">
<code>palmerpenguins</code> dataset<a class="anchor" aria-label="anchor" href="#palmerpenguins-dataset"></a>
</h3>
<p>Here we will use the <a href="https://allisonhorst.github.io/palmerpenguins/" class="external-link">palmerpenguins</a>
dataset. These data contain observations for 344 penguins. There are 3
different species of penguins in this dataset, collected from 3 islands
in the Palmer Archipelago, Antarctica.</p>
<div class="figure" style="text-align: center">
<img src="https://allisonhorst.github.io/palmerpenguins/reference/figures/lter_penguins.png" alt="Palmer penguins" width="60%"><p class="caption">
Palmer penguins
</p>
</div>
<p><span class="math display">\[**Source**: [Artwork by Allison
Horst](https://github.com/allisonhorst/stats-illustrations)\]</span></p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/" class="external-link">palmerpenguins</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 344</span></span>
<span><span class="co">## Columns: 8</span></span>
<span><span class="co">## $ species           <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…</span></span>
<span><span class="co">## $ island            <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…</span></span>
<span><span class="co">## $ bill_length_mm    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …</span></span>
<span><span class="co">## $ bill_depth_mm     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …</span></span>
<span><span class="co">## $ flipper_length_mm <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…</span></span>
<span><span class="co">## $ body_mass_g       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …</span></span>
<span><span class="co">## $ sex               <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> male, female, female, NA, female, male, female, male…</span></span>
<span><span class="co">## $ year              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…</span></span></code></pre>
<p>If we wanted to count the number of penguins for each of the three
species, we can use the <code><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count()</a></code> function in
<code>dplyr</code>:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">##   species       n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Adelie      152</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Chinstrap    68</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Gentoo      124</span></span></code></pre>
<p>For example, we see there are a total of 152 Adelie penguins in the
<code>palmerpenguins</code> dataset.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, </span>
<span>                          y <span class="op">=</span> <span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## data: species, island, bill_length_mm, bill_depth_mm,</span></span>
<span><span class="co">##   flipper_length_mm, body_mass_g, sex, year [344x8]</span></span>
<span><span class="co">## mapping:  x = ~flipper_length_mm, y = ~bill_length_mm</span></span>
<span><span class="co">## faceting: &lt;ggproto object: Class FacetNull, Facet, gg&gt;</span></span>
<span><span class="co">##     compute_layout: function</span></span>
<span><span class="co">##     draw_back: function</span></span>
<span><span class="co">##     draw_front: function</span></span>
<span><span class="co">##     draw_labels: function</span></span>
<span><span class="co">##     draw_panels: function</span></span>
<span><span class="co">##     finish_data: function</span></span>
<span><span class="co">##     init_scales: function</span></span>
<span><span class="co">##     map_data: function</span></span>
<span><span class="co">##     params: list</span></span>
<span><span class="co">##     setup_data: function</span></span>
<span><span class="co">##     setup_params: function</span></span>
<span><span class="co">##     shrink: TRUE</span></span>
<span><span class="co">##     train_scales: function</span></span>
<span><span class="co">##     vars: function</span></span>
<span><span class="co">##     super:  &lt;ggproto object: Class FacetNull, Facet, gg&gt;</span></span></code></pre>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "gg"     "ggplot"</span></span></code></pre>
<p>You can see above that the object <code>g</code> contains the dataset
<code>penguins</code> and the mappings.</p>
<p>Now, normally if you were to <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> a
<code>ggplot</code> object a plot would appear on the plot device,
however, our object <code>g</code> actually does not contain enough
information to make a plot yet.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, </span>
<span>                 y <span class="op">=</span> <span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="data-viz_files/figure-html/unnamed-chunk-46-1.png" alt="Nothing to see here!" width="700"><p class="caption">
Nothing to see here!
</p>
</div>
</div>
<div class="section level3">
<h3 id="first-plot-with-point-layer">First plot with point layer<a class="anchor" aria-label="anchor" href="#first-plot-with-point-layer"></a>
</h3>
<p>To make a scatter plot, we need add at least one
<strong>geom</strong>, such as points.</p>
<p>Here, we add the <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code> function to create a
traditional scatter plot.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, </span>
<span>                 y <span class="op">=</span> <span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="data-viz_files/figure-html/unnamed-chunk-47-1.png" width="700"></p>
<p>How does ggplot know what points to plot? In this case, it can grab
them from the data frame <code>penguins</code> that served as the input
into the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> function.</p>
</div>
<div class="section level3">
<h3 id="adding-more-layers">Adding more layers<a class="anchor" aria-label="anchor" href="#adding-more-layers"></a>
</h3>
<div class="section level4">
<h4 id="smooth">smooth<a class="anchor" aria-label="anchor" href="#smooth"></a>
</h4>
<p>Because the data appear rather noisy, it might be better if we added
a smoother on top of the points to see if there is a trend in the data
with PM2.5.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="data-viz_files/figure-html/unnamed-chunk-48-1.png" alt="Scatterplot with smoother" width="700"><p class="caption">
Scatterplot with smoother
</p>
</div>
<p>The default smoother is a loess smoother, which is flexible and
nonparametric but might be too flexible for our purposes. Perhaps we’d
prefer a simple linear regression line to highlight any first order
trends. We can do this by specifying <code>method = "lm"</code> to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth()</a></code>.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span></code></pre></div>
<p><img src="data-viz_files/figure-html/unnamed-chunk-49-1.png" width="700"></p>
<p>Here, we can see there appears to be a increasing trend.</p>
<p>We can color the points by <code>species</code> and a smoother by
adding a linear regression.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, </span>
<span>             y <span class="op">=</span> <span class="va">bill_length_mm</span>, </span>
<span>             color <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span></code></pre></div>
<p><img src="data-viz_files/figure-html/unnamed-chunk-50-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="facets">facets<a class="anchor" aria-label="anchor" href="#facets"></a>
</h4>
<p>We can also stratify the scatter plot by another variable
(e.g. <code>sex</code>) by <strong>adding a
<code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid()</a></code></strong> or <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code>
function.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, </span>
<span>             y <span class="op">=</span> <span class="va">bill_length_mm</span>, </span>
<span>             color <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span></span></code></pre></div>
<p><img src="data-viz_files/figure-html/unnamed-chunk-51-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="changing-the-theme">Changing the theme<a class="anchor" aria-label="anchor" href="#changing-the-theme"></a>
</h4>
<p>The <strong>default theme for <code>ggplot2</code> uses the gray
background</strong> with white grid lines.</p>
<p>If you don’t find this suitable, you can use the black and white
theme by using the <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw()</a></code> function.</p>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw()</a></code> function also allows you to set the
typeface for the plot, in case you don’t want the default Helvetica.
Here we change the typeface to Times.</p>
<p>For things that only make sense globally, use <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code>,
i.e. <code>theme(legend.position = "none")</code>. Two standard
appearance themes are included</p>
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray()</a></code>: The default theme (gray background)</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw()</a></code>: More stark/plain</li>
</ul>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span></span></code></pre></div>
<p><img src="data-viz_files/figure-html/unnamed-chunk-52-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="modifying-labels">Modifying labels<a class="anchor" aria-label="anchor" href="#modifying-labels"></a>
</h4>
<p>There are a variety of <strong>annotations</strong> you can add to a
plot, including <strong>different kinds of labels</strong>.</p>
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab()</a></code> for x-axis labels</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab()</a></code> for y-axis labels</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle()</a></code> for specifying plot titles</li>
</ul>
<p><code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs()</a></code> function is generic and can be used to modify
multiple types of labels at once</p>
<p>:::</p>
<p>Here is an example of modifying the title and the <code>x</code> and
<code>y</code> labels to make the plot a bit more informative.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Palmer penguins"</span>, </span>
<span>       x <span class="op">=</span> <span class="st">"flipper length"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"bill length"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="data-viz_files/figure-html/unnamed-chunk-53-1.png" alt="Modifying plot labels" width="700"><p class="caption">
Modifying plot labels
</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">## Platform: aarch64-apple-darwin21.6.0 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Monterey 12.5.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /opt/homebrew/Cellar/openblas/0.3.21/lib/libopenblasp-r0.3.21.dylib</span></span>
<span><span class="co">## LAPACK: /opt/homebrew/Cellar/r/4.2.1_2/lib/R/lib/libRlapack.dylib</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] palmerpenguins_0.1.1 here_1.0.1           forcats_0.5.2       </span></span>
<span><span class="co">##  [4] stringr_1.4.1        dplyr_1.0.10         purrr_0.3.4         </span></span>
<span><span class="co">##  [7] readr_2.1.2          tidyr_1.2.0          tibble_3.1.8        </span></span>
<span><span class="co">## [10] ggplot2_3.3.6        tidyverse_1.3.2     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] httr_1.4.4          sass_0.4.2          splines_4.2.1      </span></span>
<span><span class="co">##  [4] bit64_4.0.5         vroom_1.5.7         jsonlite_1.8.0     </span></span>
<span><span class="co">##  [7] modelr_0.1.9        bslib_0.4.0         assertthat_0.2.1   </span></span>
<span><span class="co">## [10] highr_0.9           googlesheets4_1.0.1 cellranger_1.1.0   </span></span>
<span><span class="co">## [13] yaml_2.3.5          lattice_0.20-45     pillar_1.8.1       </span></span>
<span><span class="co">## [16] backports_1.4.1     glue_1.6.2          digest_0.6.29      </span></span>
<span><span class="co">## [19] rvest_1.0.3         colorspace_2.0-3    Matrix_1.4-1       </span></span>
<span><span class="co">## [22] htmltools_0.5.3     pkgconfig_2.0.3     broom_1.0.1        </span></span>
<span><span class="co">## [25] haven_2.5.1         scales_1.2.1        tzdb_0.3.0         </span></span>
<span><span class="co">## [28] googledrive_2.0.0   mgcv_1.8-40         farver_2.1.1       </span></span>
<span><span class="co">## [31] generics_0.1.3      ellipsis_0.3.2      cachem_1.0.6       </span></span>
<span><span class="co">## [34] withr_2.5.0         cli_3.3.0           magrittr_2.0.3     </span></span>
<span><span class="co">## [37] crayon_1.5.1        readxl_1.4.1        memoise_2.0.1      </span></span>
<span><span class="co">## [40] evaluate_0.16       fs_1.5.2            fansi_1.0.3        </span></span>
<span><span class="co">## [43] nlme_3.1-159        xml2_1.3.3          textshaping_0.3.6  </span></span>
<span><span class="co">## [46] tools_4.2.1         hms_1.1.2           gargle_1.2.0       </span></span>
<span><span class="co">## [49] lifecycle_1.0.1     munsell_0.5.0       reprex_2.0.2       </span></span>
<span><span class="co">## [52] compiler_4.2.1      pkgdown_2.0.6       jquerylib_0.1.4    </span></span>
<span><span class="co">## [55] systemfonts_1.0.4   rlang_1.0.5         grid_4.2.1         </span></span>
<span><span class="co">## [58] rstudioapi_0.14     labeling_0.4.2      rmarkdown_2.16     </span></span>
<span><span class="co">## [61] gtable_0.3.1        DBI_1.1.3           curl_4.3.2         </span></span>
<span><span class="co">## [64] R6_2.5.1            lubridate_1.8.0     knitr_1.40         </span></span>
<span><span class="co">## [67] fastmap_1.1.0       bit_4.0.4           utf8_1.2.2         </span></span>
<span><span class="co">## [70] rprojroot_2.0.3     ragg_1.2.2          desc_1.4.1         </span></span>
<span><span class="co">## [73] stringi_1.7.8       parallel_4.2.1      vctrs_0.4.1        </span></span>
<span><span class="co">## [76] dbplyr_2.2.1        tidyselect_1.1.2    xfun_0.32</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Stephanie C. Hicks.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
